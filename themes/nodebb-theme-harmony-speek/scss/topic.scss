body.template-topic {
	// Prevent horizontal scrolling
	overflow-x: hidden !important;
	max-width: 100vw;
	width: 100%;
	box-sizing: border-box;

	// Ensure all direct children respect width
	> * {
		max-width: 100%;
		box-sizing: border-box;
	}

	// Fix flex-fill container
	.flex-fill {
		max-width: 100%;
		width: 100%;
		overflow-x: hidden;
		box-sizing: border-box;
	}

	// Fix row containers
	.row {
		max-width: 100%;
		width: 100%;
		overflow-x: hidden;
		margin-left: 0;
		margin-right: 0;
		box-sizing: border-box;
	}
	.breadcrumb .breadcrumb-item:last-child {
		display: none;
	}

	.topic-header-container {
		gap: 16px;
		margin-bottom: 1rem;
		padding-left: 24px !important;
		padding-right: 24px !important;
		margin-top: 24px;
		max-width: 100%;
		width: 100%;
		overflow-x: hidden;
		overflow-y: visible; // Allow dropdown to overflow below
		box-sizing: border-box;
		// Prevent auto-scrolling when dropdown opens
		scroll-behavior: auto;
		
		// Ensure dropdown menus can overflow
		* {
			scroll-margin: 0;
			scroll-padding: 0;
		}
	}
	@include mobile {
		.topic-header-container {
			padding-left: 16px !important;
			padding-right: 16px !important;
		}

		.topic {
			padding-left: 16px !important;
			padding-right: 16px !important;
		}

		// .posts-container {
		// 	padding-left: 16px !important;
		// 	padding-right: 16px !important;
		// }
	}

	@include tablet {
		.topic-header-container {
			padding-left: 16px !important;
			padding-right: 16px !important;
		}

		.topic {
			padding-left: 16px !important;
			padding-right: 16px !important;
		}

		// .posts-container {
		// 	padding-left: 16px !important;
		// 	padding-right: 16px !important;
		// }
	}

	.topic-header-buttons {
		.speek-back-button {
			display: inline-flex;
			align-items: center;
			justify-content: center;
			width: 44px;
			height: 44px;
			border-radius: 9999px;
			border: 1px solid #d4d4d4;
			background: #FDFDFC;
			color: #355E66;
			text-decoration: none;
			box-shadow: 0 2px 4px -2px rgba(17, 24, 39, 0.12),
				0 1px 2px rgba(17, 24, 39, 0.08);
			transition: box-shadow 0.2s ease, transform 0.2s ease,
				color 0.2s ease, border-color 0.2s ease;

			&:hover {
				text-decoration: none;
				transform: translateY(-1px);
				box-shadow: 0 6px 12px -6px rgba(17, 24, 39, 0.2);
			}

			&:focus-visible {
				outline: none;
				border-color: #355E66;
				box-shadow: 0 0 0 3px rgba(53, 94, 102, 0.12);
			}
		}

		.speek-back-button__icon {
			display: inline-flex;
			align-items: center;
			justify-content: center;
		}

		.speek-back-button__chevron {
			width: 20px;
			height: 20px;
			color: currentColor;
		}

		.speek-back-button__label {
			position: absolute;
			width: 1px;
			height: 1px;
			padding: 0;
			margin: -1px;
			overflow: hidden;
			clip: rect(0, 0, 0, 0);
			border: 0;
		}
	}

	.topic-header-title {
		.topic-title-main {
			font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
			font-weight: 700;
			font-size: 24px;
			line-height: 1.3333333333333333em;
			color: #355E66;
			margin: 0;
			padding: 0;

			.topic-title {
				word-break: break-word;
			}
		}
	}

	.topic-space-actions {
		flex-wrap: wrap;

		.topic-badges {
			flex-wrap: wrap;
		}

		.topic-actions {
			display: flex;
			align-items: center;
			gap: 16px;
			flex-wrap: nowrap; // Keep sort and reply button in same row on mobile
			flex-shrink: 0;
			
			// Sort dropdown takes natural width
			.btn-group {
				flex-shrink: 0;
				white-space: nowrap;
				position: relative; // Ensure dropdown positioning context
				
				// Dropdown menu should overflow below content, not cause scrolling
				.dropdown-menu {
					position: absolute !important;
					top: 100% !important;
					left: 0 !important;
					right: auto !important;
					z-index: 1050 !important; // High z-index to ensure it's above other content
					margin-top: 4px !important;
					overflow: visible !important;
					// Prevent browser from auto-scrolling to keep dropdown in view
					scroll-margin: 0 !important;
					scroll-padding: 0 !important;
				}
			}
			
			// Reply button takes remaining space
			.speek-btn {
				flex: 1 1 auto;
				min-width: 0;
				white-space: nowrap;
			}
		}
	}
	
	// Hide post bar (toolbar with mark unread, watch, sort, tools, reply) on mobile and tablet
	.topic-main-buttons,
	[component="topic/main-buttons"],
	.post-bar {
		@media (max-width: 991.98px) {
			display: none !important;
		}
	}

	// Topic Badge Styles
	.speek-topic-badge {
		display: inline-flex;
		align-items: center;
		justify-content: center;
		gap: 4px;
		padding: 2px 8px;
		border-radius: 8px;
		font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
		font-size: 12px;
		font-weight: 600;
		line-height: 1.3333333333333333em;
		text-decoration: none;
		transition: all 0.2s ease;

		&__icon {
			display: inline-flex;
			align-items: center;
			justify-content: center;
			flex-shrink: 0;
		}

		&__icon-svg {
			width: 12px;
			height: 12px;
			color: currentColor;
		}

		&__text {
			color: inherit;
			font-family: inherit;
			white-space: nowrap;
		}

		&--category {
			background: #B6D3DA;
			border: 1px solid transparent;
			color: #192C30;

			&:hover {
				background: #A8C5CC;
				color: #192C30;
				text-decoration: none;
			}
		}

		&--outline {
			background: rgba(255, 255, 255, 0.5);
			border: 1px solid #F3F1E9;
			color: #355E66;
		}
	}

	// Topic Button Styles
	.speek-btn {
		display: inline-flex;
		align-items: center;
		justify-content: center;
		gap: 8px;
		padding: 8px 32px;
		border-radius: 9999px;
		font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
		font-size: 14px;
		font-weight: 700;
		line-height: 1.4285714285714286em;
		text-decoration: none;
		border: none;
		cursor: pointer;
		transition: all 0.2s ease;
		height: 44px;

		&__icon {
			display: inline-flex;
			align-items: center;
			justify-content: center;
			flex-shrink: 0;
		}

		&__icon-svg {
			width: 16px;
			height: 16px;
			color: currentColor;
		}

		&__text {
			color: inherit;
			font-family: inherit;
			white-space: nowrap;
		}

		&--lg {
			height: 44px;
		}

		&--ghost {
			background: rgba(230, 226, 210, 0.9);
			backdrop-filter: blur(12px);
			color: #355E66;
			box-shadow: 0px 2px 4px -2px rgba(0, 0, 0, 0.05), 0px 4px 6px -1px rgba(0, 0, 0, 0.05);
			padding: 8px 16px; // Figma spec: 8px 16px for sort dropdown

			&:hover {
				background: rgba(220, 216, 200, 0.95);
				color: #355E66;
				text-decoration: none;
			}

			&:focus-visible {
				outline: none;
				box-shadow: 0 0 0 3px rgba(53, 94, 102, 0.12);
			}
		}

		&--primary {
			background: #E6FF00;
			color: #27454B;
			box-shadow: 0px 2px 4px -2px rgba(0, 0, 0, 0.05), 0px 4px 6px -1px rgba(0, 0, 0, 0.05);

			&:hover {
				background: #D4E600;
				color: #27454B;
				text-decoration: none;
			}

			&:focus-visible {
				outline: none;
				box-shadow: 0 0 0 3px rgba(230, 255, 0, 0.3);
			}

			&.disabled {
				opacity: 0.6;
				cursor: not-allowed;
				pointer-events: none;
			}
		}
	}

	.topic {
		max-width: 100%;
		width: 100%;
		overflow-x: hidden;
		box-sizing: border-box;

		.posts-container {
			max-width: 100%;
			width: 100%;
			background: transparent;
			max-width: 100%;
			width: 100%;
			overflow-x: hidden;
			box-sizing: border-box;
		}

		.posts {
			// Timeline style disabled for card-based design
			// @include timeline-style;

			.post-header {
				font-size: 0.8125rem;
				line-height: 1.25rem;

				.bookmarked {
					transition: $transition-fade;
				}
			}

		[component="post"] {
			&.selected .post-container {
				background-color: mix($body-bg, $body-color, 90%);
			}
			&.deleted .post-container .content { opacity: .65; }

			[component="post/content"] {
				background-color: #FDFDFC !important;
				@include fix-lists();

				> blockquote {
					> blockquote {
						> *:not(.blockquote) {
							display: none;
						}
					}

					> blockquote.uncollapsed {
						> *:not(.blockquote) {
							display: block;
						}
					}
				}

				@include media-breakpoint-up(lg) {
					table { // text-break breaks table formatting
					 	word-break:initial!important;
					}
				}
			}
		}

		// Topic Post Card Styles (Figma Design)
		.speek-topic-post-card {
			background: #FDFDFC;
			// background-color: #FDFDFC;
			border-radius: 16px;
			padding: 16px;
			display: flex;
			flex-direction: column;
			gap: 16px;
			margin-bottom: 0;
			border: none;
			box-shadow: none;

			// Admin action buttons
			.speek-post-actions {
				display: flex;
				align-items: center;
				gap: 8px;
				margin-top: 8px;
				padding-top: 8px;
				border-top: 1px solid #F3F1E9;
			}

			// Ensure all content inside has correct background
			.content,
			[component="post/content"],
			.speek-post-description {
				background-color: #FDFDFC !important;
			}
			
			// Admin delete controls in content area - show for ALL posts
			.speek-post-admin-delete {
				display: block !important;
				margin-top: 12px;
				padding-top: 12px;
				border-top: 1px solid #F3F1E9;
				
				.btn-delete-admin {
					display: inline-flex;
					align-items: center;
					justify-content: center;
					gap: 6px;
					padding: 6px 12px;
					border-radius: 8px;
					background: transparent;
					border: 1px solid #E0DBC7;
					color: #dc3545;
					text-decoration: none;
					font-size: 13px;
					font-weight: 600;
					transition: all 0.2s ease;
					
					i {
						font-size: 13px;
					}
					
					&:hover {
						background: #fee;
						border-color: #dc3545;
						color: #dc3545;
						text-decoration: none;
					}
				}
			}

			// Override for reply cards
			&.speek-reply-card {
				background: #E6E2D2 !important;
				background-color: #E6E2D2 !important;
				border: 1px solid #E0DBC7 !important;
				padding: 16px;
				gap: 12px;
				margin-bottom: 0;

				.content,
				[component="post/content"],
				.speek-post-description {
					background-color: #E6E2D2 !important;
				}
			}

			&.deleted {
				opacity: 0.65;
			}

			// User Info Section
			.speek-post-card-header {
				display: flex;
				align-items: center;
				gap: 12px;
				// No background color for main post header - only for replies

				.speek-user-avatar {
					flex-shrink: 0;
					width: 48px;
					height: 48px;
					display: inline-flex;
					align-items: center;
					justify-content: center;
					border-radius: 9999px;
					overflow: hidden;
					cursor: default !important;
					pointer-events: none !important;

					img {
						width: 100%;
						height: 100%;
						object-fit: cover;
						pointer-events: none !important;
					}

					// Make avatar badges non-clickable
					[component="user/status"],
					[component="user/locality"],
					.status,
					.small {
						pointer-events: none !important;
						cursor: default !important;
					}
				}

				.speek-user-name {
					cursor: default !important;
					pointer-events: none !important;
				}

				.speek-user-info {
					display: flex;
					flex-direction: column;
					gap: 4px;
					flex: 1;
					min-width: 0;

					.speek-user-name {
						display: flex;
						align-items: center;
						gap: 4px;
						flex-wrap: wrap;

						a {
							font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
							font-size: 16px;
							font-weight: 700;
							line-height: 1.5em;
							color: #122023;
							text-decoration: none;

							&:hover {
								color: #355E66;
							}
						}
					}

					.speek-post-timestamp {
						font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
						font-size: 14px;
						font-weight: 400;
						line-height: 1.4285714285714286em;
						color: #525252;

						.timeago {
							color: inherit;
						}
					}
				}
			}

			// Content Section
			.speek-post-card-content {
				display: flex;
				flex-direction: column;
				background-color: #FDFDFC !important;
				gap: 16px;

				.speek-post-content-wrapper {
					display: flex;
					flex-direction: column;
					gap: 8px;
				}

				.speek-post-title {
					font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
					font-size: 18px;
					font-weight: 700;
					line-height: 1.5555555555555556em;
					color: #355E66;
					margin: 0;
				}

				.speek-post-description {
					font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
					font-size: 14px;
					font-weight: 400;
					line-height: 1.6em;
					color: #525252;
					margin: 0;
					margin-bottom: 0 !important;
					
					// Remove margin-bottom from all child elements
					p,
					div,
					span,
					* {
						margin-bottom: 0 !important;
					}
					
					// Remove margin from last child
					> *:last-child {
						margin-bottom: 0 !important;
					}

					@include fix-lists();

					> blockquote {
						> blockquote {
							> *:not(.blockquote) {
								display: none;
							}
						}

						> blockquote.uncollapsed {
							> *:not(.blockquote) {
								display: block;
							}
						}
					}

					@include media-breakpoint-up(lg) {
						table {
							word-break: initial !important;
						}
					}
				}

				.speek-post-signature {
					font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
					font-size: 12px;
					color: #525252;
					margin-top: 8px;
					padding-top: 8px;
					border-top: 1px solid #F3F1E9;
				}
			}

			// Reaction Container
			.speek-post-card-footer {
				display: flex;
				flex-direction: row;
				gap: 0;
				align-items: center;
				justify-content: flex-start;
				
				// Admin controls
				.speek-admin-controls {
					display: flex;
					gap: 8px;
					align-items: center;
					padding-left: 16px;
					border-left: 1px solid #F3F1E9;
					margin-left: 16px;
					
					.btn-ghost-admin {
						display: inline-flex;
						align-items: center;
						justify-content: center;
						width: 32px;
						height: 32px;
						border-radius: 8px;
						background: transparent;
						border: 1px solid #E0DBC7;
						color: #355E66;
						text-decoration: none;
						transition: all 0.2s ease;
						
						i {
							font-size: 14px;
						}
						
						&:hover {
							background: #F3F1E9;
							border-color: #355E66;
							color: #355E66;
							text-decoration: none;
						}
						
						&[component="post/purge"]:hover {
							background: #fee;
							border-color: #dc3545;
							color: #dc3545;
						}
					}
				}

				.speek-reaction-item {
					display: flex;
					flex-direction: row;
					align-items: center;
					justify-content: flex-start;
					gap: 8px;
					width: 84px;
					height: auto;
					background: transparent;
					border: none;
					padding: 0;
					margin: 0;

					.speek-reaction-link {
						display: flex;
						flex-direction: row;
						align-items: center;
						justify-content: flex-start;
						gap: 8px;
						text-decoration: none;
						color: inherit;
						cursor: pointer;
						transition: opacity 0.2s ease;
						width: 100%;
						height: 100%;
						background: transparent;
						border: none;
						padding: 0;
						margin: 0;

						&:hover {
							opacity: 0.8;
						}

						&.active {
							.speek-reaction-icon {
								color: #355E66;
							}
						}

						&.hidden {
							display: none;
						}
					}

					.speek-reaction-icon {
						width: 24px;
						height: 24px;
						color: #355E66;
						flex-shrink: 0;
					}

					.speek-reaction-count {
						font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
						font-size: 16px;
						font-weight: 700;
						line-height: 1.5em;
						color: #355E66;
					}
				}
			}

			// Replies container
			.speek-post-replies-container {
				margin-top: 16px;
				padding-top: 16px;
				border-top: 1px solid #F3F1E9;
			}
		}

			[component="post/upvote"], [component="post/downvote"] {
				&.upvoted, &.downvoted {
					background-color: var(--btn-ghost-active-color);

					&:hover {
						background-color: var(--btn-ghost-hover-color);
					}
				}
			}
		}
	}

	.quick-reply {
		@include topic-avatars();
	}

	// Quick Reply Styles (Figma Design)
	.speek-quick-reply {
		margin-top: 24px;
		
		.speek-quick-reply-label {
			font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
			font-size: 16px;
			font-weight: 400;
			line-height: 1.5em;
			color: #122023;
			margin: 0;
		}

		.speek-quick-reply-textarea-wrapper {
			position: relative;
			background: #FDFDFC;
			border: 1px solid #D4D4D4;
			border-radius: 8px;
			box-shadow: 0px 1px 2px 0px rgba(0, 0, 0, 0.05);
			padding: 8px 12px;
			display: flex;
			flex-direction: column;
			gap: 4px;
			min-height: 80px;
			transition: border-color 0.2s ease;
			
			&.speek-error {
				border-color: #DC2626 !important;
				
				&:focus-within {
					border-color: #DC2626 !important;
				}
			}

			&:focus-within {
				outline: none;
				border-color: #D4D4D4;
				box-shadow: 0px 1px 2px 0px rgba(0, 0, 0, 0.05);
			}
			
			&.speek-error:focus-within {
				border-color: #DC2626 !important;
			}

			.speek-quick-reply-char-count {
				display: flex;
				align-items: center;
				justify-content: flex-start;
				font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
				font-size: 12px;
				font-weight: 700;
				line-height: 1.3333333333333333em;
				color: #D4D4D4;
				margin-top: 4px;

				span[component="topic/quickreply/char-current"] {
					color: #D4D4D4;
				}

				span[component="topic/quickreply/char-max"] {
					color: #D4D4D4;
				}
			}

			.speek-quick-reply-textarea {
				font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
				font-size: 14px;
				font-weight: 400;
				line-height: 1.4285714285714286em;
				color: #122023;
				background: #FDFDFC;
				border: none !important;
				resize: none;
				outline: none !important;
				padding: 0;
				min-height: 80px;
				width: 100%;
				box-shadow: none !important;

				&::placeholder {
					color: #525252;
				}

				&:focus {
					outline: none !important;
					box-shadow: none !important;
					border: none !important;
				}

				&:active {
					outline: none !important;
					box-shadow: none !important;
					border: none !important;
				}
			}

			.imagedrop {
				position: absolute;
				top: 0;
				left: 0;
				right: 0;
				bottom: 0;
				display: none;
				align-items: center;
				justify-content: center;
				background: rgba(255, 255, 255, 0.9);
				border-radius: 8px;
				z-index: 10;

				&.active {
					display: flex;
				}
			}
		}

		// Error message styling (similar to create new post modal)
		.speek-error-message {
			font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
			font-size: 14px;
			font-weight: 400;
			line-height: 1.4285714285714286em;
			color: #DC2626;
			margin-top: 4px;
			min-height: 20px;
			display: none;

			&.show {
				display: block;
			}
		}

		.speek-quick-reply-submit-btn {
			font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
			font-size: 14px;
			font-weight: 700;
			line-height: 1.4285714285714286em;
			color: #27454B;
			background: #E6FF00;
			border: none;
			border-radius: 9999px;
			padding: 8px 16px;
			height: 36px;
			display: inline-flex;
			align-items: center;
			justify-content: center;
			width: auto;
			max-width: 121px;
			box-shadow: 0px 2px 4px -2px rgba(0, 0, 0, 0.05), 0px 4px 6px -1px rgba(0, 0, 0, 0.05);
			cursor: pointer;
			transition: box-shadow 0.2s ease, transform 0.2s ease;

			&:hover {
				transform: none;
				box-shadow: 0px 2px 4px -2px rgba(0, 0, 0, 0.05), 0px 4px 6px -1px rgba(0, 0, 0, 0.05);
			}

			&:active {
				transform: translateY(0);
				box-shadow: 0px 2px 4px -2px rgba(0, 0, 0, 0.05), 0px 4px 6px -1px rgba(0, 0, 0, 0.05);
			}

			&:focus {
				outline: none;
				box-shadow: 0px 2px 4px -2px rgba(0, 0, 0, 0.05), 0px 4px 6px -1px rgba(0, 0, 0, 0.05), 0 0 0 3px rgba(230, 255, 0, 0.3);
			}

			&:disabled {
				opacity: 0.6;
				cursor: not-allowed;
				transform: none;
			}
		}
	}

	[component="post/parent"] {
		margin-left: 2.5rem;
		[component="post/parent/content"] > p:last-child {
			margin-bottom: 0;
		}
		&[data-collapsed="true"] {
			> [component="post/parent/content"] > * {
				font-size: 13px!important;
				line-height: var(--bs-btn-line-height)!important;
			}
		}
	}

	[component="post/replies/container"] {
		.icon {
			display: none !important;
		}

		.post-header .icon {
			display: initial !important;

			.status {
				display: none;
			}
		}

		.timeline-event {
			display: none !important;
		}

		[component="post"] {
			padding-top: 0 !important;
			padding-bottom: $spacer;
			&:last-of-type {
				padding-bottom: 0;
				.post-footer {
					padding-bottom: 0!important;
					border-bottom: none !important;
				}
			}
		}

		// Apply reply card styles to all posts inside replies container
		.speek-topic-post-card {
			background: #E6E2D2 !important;
			border: 1px solid #E0DBC7 !important;
			border-radius: 16px;
			padding: 16px;
			gap: 12px;
			margin-bottom: 24px;

			// Show footer for admin controls in replies
			.speek-post-card-footer {
				display: none !important;
			}
			
			// Admin delete controls for reply cards - SHOW for replies
			.speek-post-admin-delete {
				display: block !important; // Override the hide for replies
				margin-top: 12px;
				padding-top: 12px;
				border-top: 1px solid #D4CFBC;
				background: #E6E2D2 !important;
				
				.btn-delete-admin {
					display: inline-flex;
					align-items: center;
					justify-content: center;
					gap: 6px;
					padding: 6px 12px;
					border-radius: 8px;
					background: transparent;
					border: 1px solid #D4CFBC;
					color: #dc3545;
					text-decoration: none;
					font-size: 13px;
					font-weight: 600;
					transition: all 0.2s ease;
					
					i {
						font-size: 13px;
					}
					
					&:hover {
						background: rgba(255, 238, 238, 0.8);
						border-color: #dc3545;
						color: #dc3545;
						text-decoration: none;
					}
				}
			}

			.speek-post-card-header {
				gap: 12px;
				padding: 4px 0 0 0;

				.speek-user-info {
					gap: 0;

					.speek-user-name {
						a {
							font-size: 16px;
							font-weight: 700;
							line-height: 1.5em;
							color: #122023;
						}
					}

					.speek-post-timestamp {
						font-size: 14px;
						font-weight: 400;
						line-height: 1.4285714285714286em;
						color: #525252;
					}
				}
			}

			.speek-post-card-content {
				gap: 0;
				padding: 0;

				.speek-post-content-wrapper {
					gap: 0;
				}

				.speek-post-description {
					font-size: 16px;
					font-weight: 400;
					line-height: 1.5em;
					color: #122023;
					background-color: #E6E2D2 !important;
					margin-bottom: 0 !important;
					
					// Remove margin-bottom from all child elements
					p,
					div,
					span,
					* {
						margin-bottom: 0 !important;
					}
					
					// Remove margin from last child
					> *:last-child {
						margin-bottom: 0 !important;
					}
				}
			}

			.speek-post-card-footer {
				display: none;
			}

			.content,
			[component="post/content"] {
				background-color: #E6E2D2 !important;
			}
		}
	}

	// Nested Reply/Comment Styles (Figma Design) - Most specific selector
	.speek-topic-post-card.speek-reply-card,
	[component="post"].speek-reply-card .speek-topic-post-card,
	[component="post"].speek-reply-card,
	.speek-post-replies-container .speek-topic-post-card,
	.speek-post-card.speek-reply-card {
		background: #E6E2D2 !important;
		background-color: #E6E2D2 !important;
		border: 1px solid #E0DBC7 !important;
		border-radius: 16px !important;
		padding: 16px !important;
		display: flex !important;
		flex-direction: column !important;
		gap: 12px !important;
		margin-bottom: 0 !important;

		// Hide footer for reply cards
		.speek-post-card-footer {
			display: none !important;
		}
		
		// Show admin delete controls for reply cards
		.speek-post-admin-delete {
			display: block !important; // Show in reply cards
			background: #E6E2D2 !important;
			
			.btn-delete-admin {
				display: inline-flex !important; // Ensure button shows
			}
		}

		// Ensure all nested components have the correct background
		// Header background color only for child posts (replies)
		.speek-post-card-header {
			background-color: #E6E2D2 !important;
			background: #E6E2D2 !important;
			display: flex !important;
			flex-direction: row !important;
			align-items: center !important;
			gap: 12px !important;
			padding: 4px 0 0 0 !important;
			width: 100% !important;
			align-self: stretch !important;

			.speek-user-avatar {
				width: 48px !important;
				height: 48px !important;
				flex-shrink: 0 !important;
				background-color: #F6FFA3 !important;
				background: #F6FFA3 !important;
				cursor: default !important;
				pointer-events: none !important;

				img {
					pointer-events: none !important;
				}

				// Make avatar badges non-clickable
				[component="user/status"],
				[component="user/locality"],
				.status,
				.small {
					pointer-events: none !important;
					cursor: default !important;
				}
			}

			.speek-user-info {
				background-color: #E6E2D2 !important;
				background: #E6E2D2 !important;
				display: flex !important;
				flex-direction: column !important;
				gap: 0 !important;
				flex: 1 !important;
				min-width: 0 !important;

				.speek-user-name {
					background-color: #E6E2D2 !important;
					background: #E6E2D2 !important;
					font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;
					font-size: 16px !important;
					font-weight: 700 !important;
					line-height: 1.5em !important;
					color: #122023 !important;
					cursor: default !important;
					pointer-events: none !important;
				}

				.speek-post-timestamp {
					background-color: #E6E2D2 !important;
					background: #E6E2D2 !important;
					font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;
					font-size: 14px !important;
					font-weight: 400 !important;
					line-height: 1.4285714285714286em !important;
					color: #525252 !important;

					.timeago {
						color: #525252 !important;
						background-color: #E6E2D2 !important;
						background: #E6E2D2 !important;
					}
				}
			}
		}

		.speek-post-card-content {
			background-color: #E6E2D2 !important;
			background: #E6E2D2 !important;
			display: flex !important;
			flex-direction: column !important;
			gap: 16px !important;
			padding: 0 !important;
			width: 100% !important;

			.speek-post-content-wrapper {
				background-color: #E6E2D2 !important;
				background: #E6E2D2 !important;
				display: flex !important;
				flex-direction: column !important;
				gap: 0 !important;
			}

			.speek-post-description {
				font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;
				font-size: 16px !important;
				font-weight: 400 !important;
				line-height: 1.5em !important;
				color: #122023 !important;
				background-color: #E6E2D2 !important;
				background: #E6E2D2 !important;
				margin-bottom: 0 !important;
				
				// Remove margin-bottom from all child elements
				p,
				div,
				span,
				* {
					margin-bottom: 0 !important;
				}
				
				// Remove margin from last child
				> *:last-child {
					margin-bottom: 0 !important;
				}
			}
		}

		// Ensure all content inside has correct background
		.content,
		[component="post/content"],
		.speek-post-signature,
		p,
		div:not(.speek-user-avatar):not(.speek-user-avatar *),
		span:not(.speek-user-avatar *):not(.speek-user-avatar span) {
			background-color: #E6E2D2 !important;
			background: #E6E2D2 !important;
			color: #122023 !important;
		}

		// Ensure links have the background
		a:not(.speek-user-avatar a):not(.speek-user-avatar *) {
			background-color: #E6E2D2 !important;
			background: #E6E2D2 !important;
		}

		// Preserve avatar background (should remain as is)
		.speek-user-avatar,
		.speek-user-avatar a,
		.speek-user-avatar *,
		.speek-user-avatar img,
		.speek-user-avatar span,
		.speek-user-avatar i {
			background-color: transparent !important;
			background: transparent !important;
		}
	}


	[component="topic/thumb/list"] > a{
		height: calc($font-size-base * 4);
	}
	
	// Hide progress bar and pagination
	.navigator-mobile,
	.pagination-block,
	.pagination-container,
	[component="pagination"] {
		display: none !important;
	}
	
	// Remove bottom spacing
	.posts-container,
	.posts.timeline {
		padding-top: 0 !important;
		padding-bottom: 0 !important;
		margin-bottom: 0 !important;
	}
	
	// Remove bottom margin from last post
	.posts.timeline > li:last-child {
		margin-bottom: 0 !important;
		padding-bottom: 0 !important;
	}
	
	// Remove bottom spacing from containers
	.d-flex.flex-column.gap-3 {
		margin-bottom: 0 !important;
		padding-bottom: 0 !important;
	}
	
	.row.mb-4 {
		margin-bottom: 0 !important;
	}
	
	// Remove bottom margin from quick reply
	.speek-quick-reply {
		margin-bottom: 0 !important;
	}
	
	// Remove bottom spacing from topic container
	.topic {
		margin-bottom: 0 !important;
		padding-bottom: 0 !important;
	}
	
	// Remove footer widget area spacing
	[data-widget-area="footer"] {
		margin-top: 0 !important;
		padding-top: 0 !important;
	}
}

@include media-breakpoint-up(lg) {
	body.template-topic {
		padding-bottom: 48px;

		.topic {
			margin-bottom: 48px;
			padding-bottom: 32px;
		}

		.posts-container {
			padding-bottom: 32px;
		}

		.topic .posts {
			[component="post"] {
				[component="post/actions"] {
					opacity: 0;
					transition: $transition-fade;

					&:has([aria-expanded="true"]) {
						opacity: 1;
					}
				}
				[component="post/actions"]:focus-within {
					opacity: 1;
				}
				&:hover {
					> div > .post-container > [component="post/footer"] > div > [component="post/actions"] {
						opacity: 1;
					}
				}
			}
		}
	}
}